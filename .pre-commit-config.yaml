default_stages: [commit, push]
default_language_version:
    python: python3.10
minimum_pre_commit_version: 2.20.0

repos:
    - repo: meta
      hooks:
          - id: check-hooks-apply
            stages: [manual]
          - id: check-useless-excludes
            stages: [manual]

    - repo: https://github.com/asottile/setup-cfg-fmt
      rev: v1.20.1
      hooks:
          # Run only manually because it deletes comments
          - id: setup-cfg-fmt
            name: format setup.cfg
            stages: [manual]

    - repo: https://github.com/pre-commit/pre-commit-hooks
      rev: v4.3.0
      hooks:
          - id: check-case-conflict
          - id: check-merge-conflict
          - id: check-shebang-scripts-are-executable
          - id: check-symlinks
          # - id: check-toml
          - id: check-yaml
          - id: debug-statements
          - id: destroyed-symlinks
          # - id: fix-encoding-pragma
          #   args: [--remove]
          - id: name-tests-test
            args: [--pytest-test-first]

    - repo: https://gitlab.com/bmares/check-json5
      rev: v1.0.0
      hooks:
          # replaces builtin 'check-json' hook from pre-commit using
          # json5 library with support for JSON comments
          - id: check-json5

    - repo: https://github.com/Lucas-C/pre-commit-hooks
      rev: v1.3.0
      hooks:
          - id: insert-license
            name: add license for all ICON4Py Python source files
            types: [python]
            args:
                [
                    --comment-style,
                    "|#|",
                    --license-filepath,
                    .license_header.txt,
                    --fuzzy-match-generates-todo,
                ]

    - repo: https://github.com/macisamuele/language-formatters-pre-commit-hooks
      rev: v2.4.0
      hooks:
          - id: pretty-format-ini
            name: format INI config files
            args: [--autofix]
          # - id: pretty-format-toml
          #   args: [--autofix]

    - repo: https://github.com/pre-commit/mirrors-prettier
      rev: v2.2.1
      hooks:
          - id: prettier
            name: format JSON/YAML/Markdown files
            args: [--prose-wrap=never, --print-width=88, --editorconfig]
            types_or: [json, yaml, markdown]

    - repo: https://github.com/asottile/yesqa
      rev: v1.3.0
      hooks:
          - id: yesqa

    - repo: https://github.com/psf/black
      rev: 22.3.0
      hooks:
          - id: black
            name: black Python formatter
            args: [--target-version, py310]

    - repo: https://github.com/asottile/blacken-docs
      rev: v1.12.1
      hooks:
          - id: blacken-docs
            name: black Python formatter for docstrings
            additional_dependencies: [black==22.3.0]

    - repo: https://github.com/pre-commit/mirrors-isort
      rev: v5.10.1
      hooks:
          - id: isort
            name: sort Python imports
            args: ["--profile", "black", --line-length=72]

    - repo: https://gitlab.com/PyCQA/flake8
      rev: 4.0.1
      hooks:
          - id: flake8
            name: flake8 code style checks
            additional_dependencies:
                - darglint
                - flake8-bugbear
                - flake8-builtins
                - flake8-debugger
                - flake8-docstrings
                - flake8-eradicate
                - flake8-mutable
                # Disabled for now due to random false positives
                # - flake8-rst-docstrings
                - pygments

    - repo: https://github.com/pre-commit/mirrors-mypy
      rev: v0.942
      hooks:
          - id: mypy
            name: mypy static type checker
            args: [--install-types, --non-interactive]
            exclude: |
                (?x)(
                /setup\.py$ |
                /tests/.* |
                /atm_dyn_iconam/.*
                )$
