# All installation needs to be user installations, otherwise it's not preserved on restarts
# except pre-commit which doesn't work with PIP_USER=yes (therefore the alias)
image:
  file: .gitpod.Dockerfile
tasks:
- name: Setup venv
  before: |
    mkdir -p ~/.cache
    mkdir -p /workspace/.caches/pre-commit
    ln -s /workspace/.caches/pre-commit  ~/.cache/pre-commit
  init: |
    python -m venv .venv
    source .venv/bin/activate
    pip install --upgrade pip setuptools wheel
    pip install -r requirements-dev.txt
    pre-commit install --install-hooks
    deactivate
  command: source .venv/bin/activate
  env:
    PIP_SRC: _external_src
vscode:
  extensions:
    - ms-python.python
    - genuitecllc.codetogether
